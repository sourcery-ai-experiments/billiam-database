{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.3", "generated_at": "2024-06-23T18:45:49.611740Z", "invocation_id": "d82a0661-f878-4025-a8cb-6ff081913cd1", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:48.731282Z", "completed_at": "2024-06-23T18:45:48.782892Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:48.783411Z", "completed_at": "2024-06-23T18:45:48.783423Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.053226470947265625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.billiam_database.stg__daily_tracker", "compiled": true, "compiled_code": "\n\n\n\n    with recursive\n    src_tracker as (\n        select *\n        from 'billiam_database/models/source/daily_tracker.csv'\n    ),\n\nfinal as (\n    select\n        date_time::timestamp as date_time,\n        trim(\"task\") as project,\n        coalesce(trim(detail), '') as detail,\n        \"interval\"::integer as minutes,\n        trim(company) as company\n    from src_tracker\n)\n\nselect * from final", "relation_name": "billiam.staging.daily_tracker"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:48.785901Z", "completed_at": "2024-06-23T18:45:48.789509Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:48.789962Z", "completed_at": "2024-06-23T18:45:48.789968Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0052738189697265625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.billiam_database.stg__finances", "compiled": true, "compiled_code": "\n\n\n\n    with recursive\n    src_finances as (\n        select *\n        from 'billiam_database/models/source/finances.csv'\n    ),\n\nfinal as (\n    -- noqa: disable=RF06\n    select\n        row_number() over () as row_id,  /* Just for maintaining uniqueness */\n        \"Transaction\"::int as transaction_id,\n        \"Date\"::date as transaction_date,\n        trim(\"Item\") as item,\n        translate(\"Cost\", '\u00a3,', '')::decimal(18, 2) as \"cost\",\n        trim(\"Category\") as category,\n        trim(\"Retailer\") as counterparty,\n        trim(\"Payment Method\") as payment_method,  -- noqa: RF05\n        coalesce(\"Exclusion\"::bool, false) as exclusion_flag,\n        \"Reimbursement Transaction\"::int as reimbursement_transaction_id  -- noqa: RF05\n    from src_finances\n    -- noqa: enable=RF06\n)\n\nselect * from final", "relation_name": "billiam.staging.finances"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:48.792329Z", "completed_at": "2024-06-23T18:45:48.795611Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:48.796064Z", "completed_at": "2024-06-23T18:45:48.796070Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004741191864013672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.billiam_database.stg__monzo_transactions", "compiled": true, "compiled_code": "\n\n\n\n    with recursive\n    src_monzo_transactions as (\n        select *\n        from 'billiam_database/models/source/monzo_transactions.csv'\n    ),\n\nfinal as (\n    -- noqa: disable=RF06\n    select\n        \"Transaction ID\" as transaction_id,  -- noqa: RF05\n        \"Date\"::date as transaction_date,\n        \"Time\"::time as transaction_time,\n        trim(\"Type\") as \"type\",\n        trim(\"Name\") as counterparty,\n        \"Emoji\" as emoji,\n        trim(\"Category\") as category,\n        -\"Amount\"::decimal(18, 2) as \"cost\",\n        \"Currency\" as currency,\n        -\"Local amount\"::decimal(18, 2) as local_cost,  -- noqa: RF05\n        \"Local currency\" as local_currency,  -- noqa: RF05\n        \"Notes and #tags\" as notes,  -- noqa: RF05\n        \"Address\" as address,\n        trim(\"Receipt\") as receipt,\n        trim(\"Description\") as description,\n        \"Category split\" as category_split,  -- noqa: RF05\n    from src_monzo_transactions\n    -- noqa: enable=RF06\n)\n\nselect * from final", "relation_name": "billiam.staging.monzo_transactions"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:48.798447Z", "completed_at": "2024-06-23T18:45:48.801022Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:48.801454Z", "completed_at": "2024-06-23T18:45:48.801461Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003998279571533203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "operation.billiam_database.billiam_database-on-run-end-0", "compiled": true, "compiled_code": "", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:48.803561Z", "completed_at": "2024-06-23T18:45:48.807464Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:48.807915Z", "completed_at": "2024-06-23T18:45:48.807921Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0053462982177734375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "operation.billiam_database.billiam_database-on-run-start-0", "compiled": true, "compiled_code": "\n    \n    \n    \n    CREATE OR REPLACE MACRO within(expr, lower_bound, upper_bound) AS\n        GREATEST(LEAST(expr, upper_bound), lower_bound)\n    ;\n;\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:48.810018Z", "completed_at": "2024-06-23T18:45:48.811541Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:48.811990Z", "completed_at": "2024-06-23T18:45:48.811996Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0029478073120117188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.billiam_database.work_absences", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:48.814209Z", "completed_at": "2024-06-23T18:45:48.815761Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:48.816203Z", "completed_at": "2024-06-23T18:45:48.816208Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0031311511993408203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.billiam_database.work_hours", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:48.818566Z", "completed_at": "2024-06-23T18:45:48.888661Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:48.889128Z", "completed_at": "2024-06-23T18:45:48.889136Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07461881637573242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.billiam_database.pl__daily_tracker", "compiled": true, "compiled_code": "\n\n\n\n    with recursive\n    stg_tracker as (\n        select \n          /* no columns returned from star() macro */\n        from billiam.staging.daily_tracker\n    ),\n\nfinal as (\n    select\n        date_time,\n        project,\n        detail,\n        minutes,\n        company\n    from stg_tracker\n)\n\nselect * from final", "relation_name": "billiam.presentation.daily_tracker"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:48.894230Z", "completed_at": "2024-06-23T18:45:48.934310Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:48.934776Z", "completed_at": "2024-06-23T18:45:48.934781Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04385948181152344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.billiam_database.pl__task_details", "compiled": true, "compiled_code": "\n\n\n\n    with recursive\n    src_tracker as (\n        select \n          /* no columns returned from star() macro */\n        from billiam.staging.daily_tracker\n    ),\n\nfinal as (\n    select\n        grouping_id(project, detail)::integer as group_id,\n        case grouping_id(project, detail)\n            when 0 then 'Task and detail'\n            when 1 then 'Task only'\n        end as group_description,\n        project,\n        coalesce(detail, '') as detail,\n\n        count(*)::integer as total_records,\n        sum(minutes)::integer as total_time,\n        min(date_time) as start_time,\n        max(date_time) as end_time,\n    from src_tracker\n    -- noqa: disable=RF06, PRS\n    -- SQLFluff thinks that `GROUPING SETS` is a column name?!\n    group by grouping sets (\n        (project, detail),\n        (project)\n    )\n    -- noqa: enable=RF06, PRS\n)\n\nselect * from final", "relation_name": "billiam.presentation.task_details"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:48.939713Z", "completed_at": "2024-06-23T18:45:48.951770Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:48.952242Z", "completed_at": "2024-06-23T18:45:48.952246Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013614892959594727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.accepted_values_stg__daily_tracker_company__TSB__Jaja__Allica__Sainsbury_s.9489542842", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        company as value_field,\n        count(*) as n_records\n\n    from billiam.staging.daily_tracker\n    group by company\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'TSB','Jaja','Allica','Sainsbury''s'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:48.954376Z", "completed_at": "2024-06-23T18:45:48.962228Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:48.962687Z", "completed_at": "2024-06-23T18:45:48.962692Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009296417236328125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.not_null_stg__daily_tracker_company.f15160b208", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect company\nfrom billiam.staging.daily_tracker\nwhere company is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:48.964819Z", "completed_at": "2024-06-23T18:45:48.969979Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:48.970440Z", "completed_at": "2024-06-23T18:45:48.970445Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006604671478271484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.not_null_stg__daily_tracker_date_time.107b919c02", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_time\nfrom billiam.staging.daily_tracker\nwhere date_time is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:48.972553Z", "completed_at": "2024-06-23T18:45:48.976260Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:48.976719Z", "completed_at": "2024-06-23T18:45:48.976724Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005141735076904297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.not_null_stg__daily_tracker_detail.1496e623bf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect detail\nfrom billiam.staging.daily_tracker\nwhere detail is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:48.978818Z", "completed_at": "2024-06-23T18:45:48.982390Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:48.982838Z", "completed_at": "2024-06-23T18:45:48.982842Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0050013065338134766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.not_null_stg__daily_tracker_minutes.d3002618cb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect minutes\nfrom billiam.staging.daily_tracker\nwhere minutes is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:48.984920Z", "completed_at": "2024-06-23T18:45:48.988568Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:48.989044Z", "completed_at": "2024-06-23T18:45:48.989048Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005088090896606445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.not_null_stg__daily_tracker_project.ac347f4101", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect project\nfrom billiam.staging.daily_tracker\nwhere project is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:48.991120Z", "completed_at": "2024-06-23T18:45:48.996856Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:48.997321Z", "completed_at": "2024-06-23T18:45:48.997325Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0071828365325927734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.unique_stg__daily_tracker_date_time.d1b1f0cab2", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    date_time as unique_field,\n    count(*) as n_records\n\nfrom billiam.staging.daily_tracker\nwhere date_time is not null\ngroup by date_time\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:48.999447Z", "completed_at": "2024-06-23T18:45:49.039593Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:49.040056Z", "completed_at": "2024-06-23T18:45:49.040061Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04393458366394043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.billiam_database.int__transactions", "compiled": true, "compiled_code": "\n\n\n\n    with recursive\n    stg_finances as (\n        select \n          /* no columns returned from star() macro */\n        from billiam.staging.finances\n    ),\n\nfinal as (\n    select\n        transaction_id,\n        transaction_date,\n        round(sum(\"cost\"), 2) as \"cost\",\n        count(*) as item_count,\n        group_concat(distinct counterparty, '||') as counterparty,\n    from stg_finances\n    group by transaction_id, transaction_date\n    having not (count(*) = 2 and round(sum(\"cost\"), 2) = 0)  /* Exclude credit repayment transactions */\n    order by transaction_id\n)\n\nselect * from final", "relation_name": "billiam.intermediate.transactions"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:49.045146Z", "completed_at": "2024-06-23T18:45:49.050326Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:49.050781Z", "completed_at": "2024-06-23T18:45:49.050785Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006836891174316406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.not_null_stg__finances_category.47765b77f9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect category\nfrom billiam.staging.finances\nwhere category is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:49.052932Z", "completed_at": "2024-06-23T18:45:49.056487Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:49.056931Z", "completed_at": "2024-06-23T18:45:49.056936Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00496220588684082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.not_null_stg__finances_cost.437ec48b36", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cost\nfrom billiam.staging.finances\nwhere cost is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:49.059217Z", "completed_at": "2024-06-23T18:45:49.062771Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:49.063263Z", "completed_at": "2024-06-23T18:45:49.063267Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005212306976318359, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.not_null_stg__finances_counterparty.3abba3e86c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect counterparty\nfrom billiam.staging.finances\nwhere counterparty is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:49.065338Z", "completed_at": "2024-06-23T18:45:49.068998Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:49.069457Z", "completed_at": "2024-06-23T18:45:49.069461Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005088090896606445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.not_null_stg__finances_exclusion_flag.ed5156eebb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect exclusion_flag\nfrom billiam.staging.finances\nwhere exclusion_flag is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:49.071587Z", "completed_at": "2024-06-23T18:45:49.075147Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:49.075603Z", "completed_at": "2024-06-23T18:45:49.075607Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005016326904296875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.not_null_stg__finances_item.58714b3ccc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect item\nfrom billiam.staging.finances\nwhere item is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:49.077714Z", "completed_at": "2024-06-23T18:45:49.081371Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:49.081820Z", "completed_at": "2024-06-23T18:45:49.081824Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0051381587982177734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.not_null_stg__finances_payment_method.3423839e55", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect payment_method\nfrom billiam.staging.finances\nwhere payment_method is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:49.083950Z", "completed_at": "2024-06-23T18:45:49.087630Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:49.088078Z", "completed_at": "2024-06-23T18:45:49.088083Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005175352096557617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.not_null_stg__finances_row_id.b35b6b6055", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect row_id\nfrom billiam.staging.finances\nwhere row_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:49.090180Z", "completed_at": "2024-06-23T18:45:49.093795Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:49.094248Z", "completed_at": "2024-06-23T18:45:49.094253Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005028247833251953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.not_null_stg__finances_transaction_date.c4a917f991", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect transaction_date\nfrom billiam.staging.finances\nwhere transaction_date is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:49.096383Z", "completed_at": "2024-06-23T18:45:49.101555Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:49.102004Z", "completed_at": "2024-06-23T18:45:49.102008Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00660252571105957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.not_null_stg__finances_transaction_id.a4c3a99b45", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect transaction_id\nfrom billiam.staging.finances\nwhere transaction_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:49.104116Z", "completed_at": "2024-06-23T18:45:49.111670Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:49.112133Z", "completed_at": "2024-06-23T18:45:49.112137Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008996248245239258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.relationships_stg__finances_reimbursement_transaction_id__transaction_id__ref_stg__finances_.ea59af76e0", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select reimbursement_transaction_id as from_field\n    from (select * from billiam.staging.finances where reimbursement_transaction_id IS NOT NULL) dbt_subquery\n    where reimbursement_transaction_id is not null\n),\n\nparent as (\n    select transaction_id as to_field\n    from billiam.staging.finances\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:49.114244Z", "completed_at": "2024-06-23T18:45:49.117825Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:49.118281Z", "completed_at": "2024-06-23T18:45:49.118286Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005017518997192383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.unique_stg__finances_row_id.eaaeda8cae", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    row_id as unique_field,\n    count(*) as n_records\n\nfrom billiam.staging.finances\nwhere row_id is not null\ngroup by row_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:49.120402Z", "completed_at": "2024-06-23T18:45:49.183685Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:49.184157Z", "completed_at": "2024-06-23T18:45:49.184161Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06719303131103516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.assert__monzo_transactions_reconcile__tfl", "compiled": true, "compiled_code": "\n    with recursive\n    stg_finances as (\n        select \n          /* no columns returned from star() macro */\n        from billiam.staging.finances\n    ),\n    stg_monzo_transactions as (\n        select \n          /* no columns returned from star() macro */\n        from billiam.staging.monzo_transactions\n    ),\n\nmy_txns AS (\n    SELECT\n        transaction_date,\n        SUM(cost)::NUMERIC(18, 2) AS cost,\n    FROM stg_finances\n    WHERE counterparty = 'TfL'\n      AND payment_method = 'Monzo'\n    GROUP BY transaction_date\n),\nmonzo_txns AS (\n    SELECT\n        transaction_date,\n        SUM(cost)::NUMERIC(18, 2) AS cost,\n    FROM stg_monzo_transactions\n    WHERE counterparty = 'Transport for London'\n      AND cost != 0\n    GROUP BY transaction_date\n),\n\ndates AS (\n        SELECT MIN(transaction_date) AS transaction_date\n        FROM my_txns\n    UNION ALL\n        SELECT transaction_date + INTERVAL 1 DAY\n        FROM dates\n        WHERE transaction_date < CURRENT_DATE\n),\n\njoined AS (\n    SELECT\n        transaction_date,\n        COALESCE(my_txns.cost, 0) AS cost__mine,\n        COALESCE(monzo_txns.cost, 0) AS cost__monzo,\n\n        SUM(cost__mine)  OVER t_date AS running_cost__mine,\n        SUM(cost__monzo) OVER t_date AS running_cost__monzo,\n\n        running_cost__mine = running_cost__monzo AS match_flag\n    FROM dates\n        LEFT JOIN my_txns    USING (transaction_date)\n        LEFT JOIN monzo_txns USING (transaction_date)\n    WINDOW t_date AS (ORDER BY transaction_date)\n)\n\n/*\nFor now, we just match \"close enough\" -- this is because the transactions\nare recorded at different times between the sources _and_ because the\ngrain is different, so it's harder to join them together with integrity.\n\nRemember that the `stg__finances` model records each _journey_, whereas\nthe `stg__monzo_transactions` model records each _transaction_ which can\ncorrespond to several journeys.\n\nWe apply an 80% match threshold to the running total, so if the running\ntotal is out for more than 20% of cases we flag this as a failure.\n*/\nSELECT 1.0 * SUM(match_flag::INT) / COUNT(*) AS match_ratio\nFROM joined\nHAVING match_ratio < 0.80", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:49.189170Z", "completed_at": "2024-06-23T18:45:49.192834Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:49.193293Z", "completed_at": "2024-06-23T18:45:49.193298Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005125522613525391, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.not_null_stg__monzo_transactions_transaction_date.ef899ac49c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect transaction_date\nfrom billiam.staging.monzo_transactions\nwhere transaction_date is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:49.195447Z", "completed_at": "2024-06-23T18:45:49.200674Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:49.201130Z", "completed_at": "2024-06-23T18:45:49.201134Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006707429885864258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.not_null_stg__monzo_transactions_transaction_id.c828f70f9a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect transaction_id\nfrom billiam.staging.monzo_transactions\nwhere transaction_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:49.203267Z", "completed_at": "2024-06-23T18:45:49.206852Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:49.207396Z", "completed_at": "2024-06-23T18:45:49.207400Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005147218704223633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.not_null_stg__monzo_transactions_transaction_time.dd063588dc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect transaction_time\nfrom billiam.staging.monzo_transactions\nwhere transaction_time is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:49.209495Z", "completed_at": "2024-06-23T18:45:49.213242Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:49.213701Z", "completed_at": "2024-06-23T18:45:49.213706Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005208253860473633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.not_null_stg__monzo_transactions_type.e75292d3fe", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect type\nfrom billiam.staging.monzo_transactions\nwhere type is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:49.215834Z", "completed_at": "2024-06-23T18:45:49.219491Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:49.219949Z", "completed_at": "2024-06-23T18:45:49.219953Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005136013031005859, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.unique_stg__monzo_transactions_transaction_id.504c465268", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    transaction_id as unique_field,\n    count(*) as n_records\n\nfrom billiam.staging.monzo_transactions\nwhere transaction_id is not null\ngroup by transaction_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:49.222028Z", "completed_at": "2024-06-23T18:45:49.225667Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:49.226124Z", "completed_at": "2024-06-23T18:45:49.226128Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005066633224487305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.not_null_work_absences_absence_date.6df00c466e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect absence_date\nfrom billiam.seeds.work_absences\nwhere absence_date is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:49.228230Z", "completed_at": "2024-06-23T18:45:49.231873Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:49.232326Z", "completed_at": "2024-06-23T18:45:49.232330Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005067586898803711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.not_null_work_absences_absence_reason.39f7511d73", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect absence_reason\nfrom billiam.seeds.work_absences\nwhere absence_reason is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:49.234401Z", "completed_at": "2024-06-23T18:45:49.238103Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:49.238558Z", "completed_at": "2024-06-23T18:45:49.238562Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005124330520629883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.not_null_work_absences_hours.ac1cd2c5d2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect hours\nfrom billiam.seeds.work_absences\nwhere hours is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:49.240653Z", "completed_at": "2024-06-23T18:45:49.245589Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:49.246036Z", "completed_at": "2024-06-23T18:45:49.246040Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0063402652740478516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.unique_work_absences_absence_date.50507b904f", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    absence_date as unique_field,\n    count(*) as n_records\n\nfrom billiam.seeds.work_absences\nwhere absence_date is not null\ngroup by absence_date\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:49.248141Z", "completed_at": "2024-06-23T18:45:49.300402Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:49.300859Z", "completed_at": "2024-06-23T18:45:49.300863Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05616497993469238, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.billiam_database.pl__working_hours", "compiled": true, "compiled_code": "\n\n\n\n    with recursive\n    seeds_work_hours as (\n        select \n          /* no columns returned from star() macro */\n        from billiam.seeds.work_hours\n    ),\n    seeds_work_absences as (\n        select \n          /* no columns returned from star() macro */\n        from billiam.seeds.work_absences\n    ),\n\ndates (week_starting) as (\n    -- noqa: disable=LT02\n        select date_trunc('week', (select min(from_date) from seeds_work_hours))\n    union all\n        select week_starting + interval '1 week'\n        from dates\n        where week_starting < current_date - interval '1 week'\n    -- noqa: enable=LT02\n),\n\nscheduled_hours as (\n    select\n        from_date,\n        to_date,\n        (0  -- noqa: LT02\n            + sunday\n            + monday\n            + tuesday\n            + wednesday\n            + thursday\n            + friday\n            + saturday\n        ) as scheduled_hours\n    from seeds_work_hours\n),\n\nabsence_hours as (\n    select\n        date_trunc('week', absence_date) as week_starting,\n        sum(hours) as absence_hours\n    from seeds_work_absences\n    group by all\n),\n\nall_hours as (\n    select\n        dates.week_starting,\n        coalesce(scheduled_hours.scheduled_hours, 0) as scheduled_hours,\n        coalesce(absence_hours.absence_hours, 0) as absence_hours\n    from dates\n        left join scheduled_hours\n            on dates.week_starting between scheduled_hours.from_date and scheduled_hours.to_date\n        left join absence_hours\n            using (week_starting)\n),\n\nfinal as (\n    select\n        week_starting,\n        scheduled_hours,\n        absence_hours,\n        scheduled_hours - absence_hours as expected_working_hours\n    from all_hours\n    order by week_starting\n)\n\nselect * from final", "relation_name": "billiam.presentation.working_hours"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:49.305847Z", "completed_at": "2024-06-23T18:45:49.315289Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:49.315755Z", "completed_at": "2024-06-23T18:45:49.315759Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010904073715209961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.dbt_utils_unique_combination_of_columns_work_hours_company__from_date.858d4a1809", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        company, from_date\n    from billiam.seeds.work_hours\n    group by company, from_date\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:49.317880Z", "completed_at": "2024-06-23T18:45:49.321638Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:49.322092Z", "completed_at": "2024-06-23T18:45:49.322096Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0051996707916259766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.not_null_work_hours_company.1e9ed15af3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect company\nfrom billiam.seeds.work_hours\nwhere company is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:49.324192Z", "completed_at": "2024-06-23T18:45:49.327860Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:49.328308Z", "completed_at": "2024-06-23T18:45:49.328312Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005079507827758789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.not_null_work_hours_friday.4c6cc1eb4d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect friday\nfrom billiam.seeds.work_hours\nwhere friday is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:49.330402Z", "completed_at": "2024-06-23T18:45:49.335640Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:49.336089Z", "completed_at": "2024-06-23T18:45:49.336094Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006710529327392578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.not_null_work_hours_from_date.f8a3ee1c64", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect from_date\nfrom billiam.seeds.work_hours\nwhere from_date is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:49.338155Z", "completed_at": "2024-06-23T18:45:49.341871Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:49.342320Z", "completed_at": "2024-06-23T18:45:49.342325Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00512385368347168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.not_null_work_hours_monday.57b0e45d4a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect monday\nfrom billiam.seeds.work_hours\nwhere monday is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:49.344425Z", "completed_at": "2024-06-23T18:45:49.347989Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:49.348436Z", "completed_at": "2024-06-23T18:45:49.348441Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004978179931640625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.not_null_work_hours_saturday.c91fbd0279", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect saturday\nfrom billiam.seeds.work_hours\nwhere saturday is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:49.350512Z", "completed_at": "2024-06-23T18:45:49.354151Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:49.354609Z", "completed_at": "2024-06-23T18:45:49.354614Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005070924758911133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.not_null_work_hours_sunday.808d321779", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sunday\nfrom billiam.seeds.work_hours\nwhere sunday is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:49.356750Z", "completed_at": "2024-06-23T18:45:49.360461Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:49.360915Z", "completed_at": "2024-06-23T18:45:49.360919Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005138397216796875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.not_null_work_hours_thursday.fcc7f8a5f8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect thursday\nfrom billiam.seeds.work_hours\nwhere thursday is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:49.363010Z", "completed_at": "2024-06-23T18:45:49.366547Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:49.367002Z", "completed_at": "2024-06-23T18:45:49.367006Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004990100860595703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.not_null_work_hours_to_date.1ae3e96692", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect to_date\nfrom billiam.seeds.work_hours\nwhere to_date is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:49.369099Z", "completed_at": "2024-06-23T18:45:49.372746Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:49.373197Z", "completed_at": "2024-06-23T18:45:49.373202Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0050580501556396484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.not_null_work_hours_tuesday.5f6a123637", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect tuesday\nfrom billiam.seeds.work_hours\nwhere tuesday is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:49.375289Z", "completed_at": "2024-06-23T18:45:49.380524Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:49.381191Z", "completed_at": "2024-06-23T18:45:49.381197Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006919145584106445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.not_null_work_hours_wednesday.559ef57f09", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect wednesday\nfrom billiam.seeds.work_hours\nwhere wednesday is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:49.383363Z", "completed_at": "2024-06-23T18:45:49.442062Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:49.442522Z", "completed_at": "2024-06-23T18:45:49.442527Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0625603199005127, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.billiam_database.int__transaction_items", "compiled": true, "compiled_code": "\n\n\n\n    with recursive\n    stg_finances as (\n        select \n          /* no columns returned from star() macro */\n        from billiam.staging.finances\n    ),\n    int_transactions as (\n        select \n          /* no columns returned from star() macro */\n        from billiam.intermediate.transactions\n    ),\n\nfinal as (\n    select\n        stg_finances.row_id,\n        stg_finances.transaction_date,\n        stg_finances.transaction_id,\n        stg_finances.item,\n        stg_finances.\"cost\",\n        stg_finances.category,\n        stg_finances.counterparty,\n        stg_finances.exclusion_flag,\n    from stg_finances\n        semi join int_transactions using (transaction_id)\n    order by stg_finances.row_id\n)\n\nselect * from final", "relation_name": "billiam.intermediate.transaction_items"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:49.447758Z", "completed_at": "2024-06-23T18:45:49.460885Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:49.461362Z", "completed_at": "2024-06-23T18:45:49.461367Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.014702320098876953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.dbt_expectations_expect_column_values_to_not_match_like_pattern_int__transactions_counterparty___.9e9aa7b732", "compiled": true, "compiled_code": "\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \ncounterparty not like '%||%'\n as expression\n\n\n    from billiam.intermediate.transactions\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:49.463576Z", "completed_at": "2024-06-23T18:45:49.467248Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:49.467702Z", "completed_at": "2024-06-23T18:45:49.467707Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005184650421142578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.not_null_int__transactions_cost.a8611301e0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cost\nfrom billiam.intermediate.transactions\nwhere cost is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:49.469798Z", "completed_at": "2024-06-23T18:45:49.473504Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:49.473947Z", "completed_at": "2024-06-23T18:45:49.473952Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005129814147949219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.not_null_int__transactions_counterparty.025e0c3eba", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect counterparty\nfrom billiam.intermediate.transactions\nwhere counterparty is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:49.476046Z", "completed_at": "2024-06-23T18:45:49.481343Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:49.481805Z", "completed_at": "2024-06-23T18:45:49.481809Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006729602813720703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.not_null_int__transactions_item_count.100a08d5ac", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect item_count\nfrom billiam.intermediate.transactions\nwhere item_count is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:49.483908Z", "completed_at": "2024-06-23T18:45:49.487502Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:49.487959Z", "completed_at": "2024-06-23T18:45:49.487964Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005047321319580078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.not_null_int__transactions_transaction_id.e2594cdecd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect transaction_id\nfrom billiam.intermediate.transactions\nwhere transaction_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:49.490062Z", "completed_at": "2024-06-23T18:45:49.493682Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:49.494134Z", "completed_at": "2024-06-23T18:45:49.494138Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0050563812255859375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.unique_int__transactions_transaction_id.9091bfb381", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    transaction_id as unique_field,\n    count(*) as n_records\n\nfrom billiam.intermediate.transactions\nwhere transaction_id is not null\ngroup by transaction_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:49.496501Z", "completed_at": "2024-06-23T18:45:49.554627Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:49.555126Z", "completed_at": "2024-06-23T18:45:49.555131Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.062256574630737305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.billiam_database.pl__daily_metrics", "compiled": true, "compiled_code": "\n\n/*\n    Will break this down into smaller models later\n*/\n\n\n\n    with recursive\n    src_transactions as (\n        select \n          /* no columns returned from star() macro */\n        from billiam.intermediate.transaction_items\n    ),\n    src_tracker as (\n        select \n          /* no columns returned from star() macro */\n        from billiam.staging.daily_tracker\n    ),\n\ndate_dim as (\n    -- noqa: disable=LT02\n        select '2018-01-01'::date as metric_date\n    union all\n        select metric_date + interval 1 day\n        from date_dim\n        where metric_date < current_date\n    -- noqa: enable=LT02\n),\n\ndaily_transactions as (\n    select\n        transaction_date as metric_date,\n        sum(\"cost\") as total_cost,\n        sum(\"cost\") filter (where category not in ('Bills', 'Council Tax', 'Rent', 'Wage')) as non_essential_cost,\n        within(round(100.0 * non_essential_cost / total_cost, 4), 0, 100) as non_essential_cost_proportion,\n    from src_transactions\n    where not exclusion_flag\n    group by transaction_date\n),\n\ndaily_work as (\n    select\n        date_time::date as metric_date,\n        sum(minutes) as total_working_time,\n        sum(minutes) filter (where project = 'Meetings') as meeting_time,\n        round(100.0 * meeting_time / total_working_time, 4) as meeting_proportion,\n        round(100.0 * meeting_time / least(total_working_time, 7.5 * 60), 4) as working_day_meeting_proportion,\n    from src_tracker\n    group by date_time::date\n),\n\nfinal as (\n    select\n        date_dim.metric_date,\n\n        coalesce(daily_transactions.total_cost, 0)::decimal(18, 3) as total_cost,\n        coalesce(daily_transactions.non_essential_cost, 0)::decimal(18, 3) as non_essential_cost,\n        coalesce(daily_transactions.non_essential_cost_proportion, 0)::decimal(8, 4) as non_essential_cost_proportion,\n        coalesce(daily_work.total_working_time, 0)::int as total_working_time,\n        coalesce(daily_work.meeting_time, 0)::int as meeting_time,\n        coalesce(daily_work.meeting_proportion, 0)::decimal(8, 4) as meeting_proportion,\n        coalesce(daily_work.working_day_meeting_proportion, 0)::decimal(8, 4) as working_day_meeting_proportion,\n    from date_dim\n        left join daily_transactions using (metric_date)\n        left join daily_work using (metric_date)\n    order by date_dim.metric_date\n)\n\nselect * from final", "relation_name": "billiam.presentation.daily_metrics"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:49.560050Z", "completed_at": "2024-06-23T18:45:49.563800Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:49.564251Z", "completed_at": "2024-06-23T18:45:49.564256Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005209922790527344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.not_null_int__transaction_items_category.39e832ce25", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect category\nfrom billiam.intermediate.transaction_items\nwhere category is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:49.566351Z", "completed_at": "2024-06-23T18:45:49.571688Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:49.572141Z", "completed_at": "2024-06-23T18:45:49.572145Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006807804107666016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.not_null_int__transaction_items_cost.f2ca12359d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cost\nfrom billiam.intermediate.transaction_items\nwhere cost is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:49.574260Z", "completed_at": "2024-06-23T18:45:49.577825Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:49.578283Z", "completed_at": "2024-06-23T18:45:49.578288Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00500035285949707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.not_null_int__transaction_items_counterparty.a63d6c9f1d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect counterparty\nfrom billiam.intermediate.transaction_items\nwhere counterparty is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:49.580431Z", "completed_at": "2024-06-23T18:45:49.584106Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:49.584568Z", "completed_at": "2024-06-23T18:45:49.584572Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005124330520629883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.not_null_int__transaction_items_exclusion_flag.405d57b4a7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect exclusion_flag\nfrom billiam.intermediate.transaction_items\nwhere exclusion_flag is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:49.586659Z", "completed_at": "2024-06-23T18:45:49.590248Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:49.590714Z", "completed_at": "2024-06-23T18:45:49.590718Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0050356388092041016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.not_null_int__transaction_items_item.218672e7d8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect item\nfrom billiam.intermediate.transaction_items\nwhere item is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:49.592823Z", "completed_at": "2024-06-23T18:45:49.596480Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:49.596933Z", "completed_at": "2024-06-23T18:45:49.596937Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0050811767578125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.not_null_int__transaction_items_row_id.640af8bdb0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect row_id\nfrom billiam.intermediate.transaction_items\nwhere row_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:49.599020Z", "completed_at": "2024-06-23T18:45:49.602691Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:49.603166Z", "completed_at": "2024-06-23T18:45:49.603171Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005127668380737305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.not_null_int__transaction_items_transaction_date.2c50f9a0a5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect transaction_date\nfrom billiam.intermediate.transaction_items\nwhere transaction_date is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-23T18:45:49.605244Z", "completed_at": "2024-06-23T18:45:49.608831Z"}, {"name": "execute", "started_at": "2024-06-23T18:45:49.609287Z", "completed_at": "2024-06-23T18:45:49.609292Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005012035369873047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.billiam_database.not_null_int__transaction_items_transaction_id.59a446d3ec", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect transaction_id\nfrom billiam.intermediate.transaction_items\nwhere transaction_id is null\n\n\n", "relation_name": null}], "elapsed_time": 1.1104857921600342, "args": {"log_format": "default", "macro_debugging": false, "enable_legacy_logger": false, "strict_mode": false, "select": [], "quiet": false, "version_check": true, "log_level": "info", "send_anonymous_usage_stats": true, "favor_state": false, "write_json": true, "use_colors_file": true, "source_freshness_run_project_hooks": false, "require_explicit_package_overrides_for_builtin_materializations": true, "print": true, "vars": {}, "log_level_file": "debug", "exclude": [], "warn_error_options": {"include": [], "exclude": []}, "log_file_max_bytes": 10485760, "defer": false, "indirect_selection": "eager", "partial_parse": true, "project_dir": "billiam_database/", "static_parser": true, "printer_width": 80, "which": "generate", "cache_selected_only": false, "log_path": "billiam_database/logs", "use_colors": true, "populate_cache": true, "compile": true, "empty_catalog": false, "profiles_dir": "billiam_database/", "static": false, "invocation_command": "dbt docs generate", "partial_parse_file_diff": true, "introspect": true, "show_resource_report": false, "require_resource_names_without_spaces": false, "log_format_file": "debug"}}